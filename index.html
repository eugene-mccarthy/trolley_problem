<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moral Weights Explorer</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600&family=Fraunces:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Moral Weights Explorer</h1>
            <p class="subtitle">Explore how you weigh different lives and welfare through ethical trade-off scenarios</p>
        </header>

        <div class="tabs">
            <button class="tab active" data-tab="scenarios">Scenarios</button>
            <button class="tab" data-tab="results">Results</button>
            <button class="tab" data-tab="export">Export Data</button>
        </div>

        <!-- Scenarios Panel -->
        <div id="scenarios" class="panel active">
            <div id="introSection">
                <div class="intro-card">
                    <h2>Welcome to the Moral Weights Explorer</h2>
                    <p>This tool presents you with a series of ethical dilemmas to help explore and understand your moral intuitions. Each scenario asks you to choose between two outcomes ‚Äî there are no right or wrong answers.</p>
                    <p>Your responses will be analysed using an Elo-style ranking system to reveal the relative moral weight you place on different beings. Weights are shown relative to a baseline of 0, with positive values indicating higher priority and negative values indicating lower priority.</p>
                    <p>The scenarios cover various ethical framings: direct trade-offs, medical research, organ transplants, probability calculations, and more. You can answer as many questions as you like.</p>
                    <button class="btn btn-primary start-btn" id="startBtn">Begin Exploration</button>
                </div>
            </div>

            <div id="scenarioSection" style="display: none;">
                <div class="progress-container">
                    <div class="progress-text">
                        <span id="progressText">Question 1</span>
                        <span id="progressPercent">Keep going as long as you like</span>
                    </div>
                </div>

                <div id="scenarioContainer"></div>
            </div>
        </div>

        <!-- Results Panel -->
        <div id="results" class="panel">
            <div class="session-info" id="sessionInfo">
                Session ID: <code id="sessionId">-</code> | 
                Responses: <code id="responseCount">0</code> |
                Started: <code id="sessionStart">-</code>
            </div>

            <div class="methodology-note">
                <strong>How weights are calculated:</strong> Each entity starts at 0. When you choose to prioritise one entity over another, the winner gains points and the loser loses points. The magnitude depends on the numbers involved and context. Entities with few comparisons show preliminary scores.
            </div>

            <div class="comparison-stats" id="comparisonStats">
                <div class="stat-card">
                    <div class="stat-value" id="statAnswered">0</div>
                    <div class="stat-label">Answered</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statEntities">0</div>
                    <div class="stat-label">Entities Compared</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statCategories">0</div>
                    <div class="stat-label">Categories</div>
                </div>
            </div>

            <div class="results-section">
                <h2>Moral Weights (Relative Ranking)</h2>
                <div id="weightsContainer">
                    <div class="empty-state">
                        <div class="empty-state-icon">‚öñÔ∏è</div>
                        <p>Complete some scenarios to see your moral weights!</p>
                    </div>
                </div>
            </div>

            <div class="results-section">
                <h2>Category Averages</h2>
                <div id="categoryWeights">
                    <div class="empty-state">
                        <p>Complete some scenarios to see category weights.</p>
                    </div>
                </div>
            </div>

            <div class="untested-section">
                <h3>üîç Not Yet Compared</h3>
                <div class="untested-grid" id="untestedList"></div>
            </div>

            <div class="results-section">
                <h2>Recent Responses</h2>
                <div id="responseList">
                    <div class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <p>No responses recorded yet.</p>
                    </div>
                </div>
            </div>

            <div class="insights-box" id="insightsBox" style="display: none;">
                <h3>üìä Analysis Insights</h3>
                <div id="insightsContent"></div>
            </div>

            <div class="btn-group">
                <button class="btn btn-danger" id="resetBtn">Reset All Responses</button>
            </div>
        </div>

        <!-- Export Panel -->
        <div id="export" class="panel">
            <div class="results-section">
                <h2>Export Your Data</h2>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Copy or download your complete response data for analysis.</p>
                
                <div class="export-section">
                    <h3>JSON Data</h3>
                    <textarea class="export-textarea" id="exportData" readonly></textarea>
                    <div class="btn-group">
                        <button class="btn" id="copyDataBtn">Copy to Clipboard</button>
                        <button class="btn btn-primary" id="downloadDataBtn">Download JSON</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts (order matters!) -->
    <script src="js/config.js"></script>
    <script src="js/scenarios.js"></script>
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
</body>
</html>